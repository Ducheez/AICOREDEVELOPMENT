{% extends "base.html" %}

{% block content %}
<div class="form-container">
    <h2 class="form-title">Landlord/Tenant - Lease Agreement Case Information</h2>
    <form id="leasesForm" onsubmit="return validateForm(event)">
        <!-- Property Information -->
        <div class="form-section">
            <h3>Property Details</h3>

            <div class="form-group">
                <label class="form-label required">Property Type</label>
                <select name="propertyType" class="form-control select-field" required>
                    <option value="">Select property type</option>
                    <option value="apartment">Apartment</option>
                    <option value="house">Single-Family House</option>
                    <option value="condo">Condominium</option>
                    <option value="townhouse">Townhouse</option>
                    <option value="mobile-home">Mobile Home</option>
                    <option value="commercial">Commercial Property</option>
                    <option value="other">Other</option>
                </select>
                <input type="text" name="otherPropertyType" class="form-control" 
                       placeholder="Please specify if Other" style="display: none;">
            </div>

            <div class="form-group">
                <label class="form-label required">Property Address</label>
                <input type="text" name="propertyAddress" class="form-control" required 
                       placeholder="Full street address">
            </div>

            <div class="form-group">
                <label class="form-label required">Lease Type</label>
                <select name="leaseType" class="form-control select-field" required>
                    <option value="">Select lease type</option>
                    <option value="month-to-month">Month-to-Month</option>
                    <option value="fixed-term">Fixed-Term Lease</option>
                    <option value="short-term">Short-Term Lease</option>
                    <option value="long-term">Long-Term Lease</option>
                    <option value="verbal">Verbal Agreement</option>
                    <option value="written">Written Lease</option>
                    <option value="roommate">Roommate Agreement</option>
                    <option value="commercial">Commercial Lease</option>
                    <option value="other">Other</option>
                </select>
                <input type="text" name="otherLeaseType" class="form-control" 
                       placeholder="Please specify if Other" style="display: none;">
            </div>
        </div>

        <!-- Lease Terms -->
        <div class="form-section">
            <h3>Lease Terms and Conditions</h3>

            <div class="form-group">
                <label class="form-label required">Lease Start Date</label>
                <input type="date" name="leaseStartDate" class="form-control" required>
            </div>

            <div class="form-group">
                <label class="form-label">Lease End Date</label>
                <input type="date" name="leaseEndDate" class="form-control">
            </div>

            <div class="form-group">
                <label class="form-label required">Monthly Rent Amount</label>
                <input type="number" name="monthlyRent" class="form-control currency-input" 
                       placeholder="Monthly rent amount" required min="0">
            </div>

            <div class="form-group">
                <label class="form-label">Security Deposit Amount</label>
                <input type="number" name="securityDeposit" class="form-control currency-input" 
                       placeholder="Security deposit amount" min="0">
            </div>

            <div class="form-group">
                <label class="form-label">Lease Renewal Options</label>
                <div class="checkbox-group">
                    <div class="checkbox-option">
                        <input type="checkbox" name="renewalOptions" value="auto-renew" id="autoRenew">
                        <label for="autoRenew">Automatic Renewal</label>
                    </div>
                    <div class="checkbox-option">
                        <input type="checkbox" name="renewalOptions" value="negotiated" id="negotiatedRenewal">
                        <label for="negotiatedRenewal">Negotiated Renewal</label>
                    </div>
                    <div class="checkbox-option">
                        <input type="checkbox" name="renewalOptions" value="no-renewal" id="noRenewal">
                        <label for="noRenewal">No Renewal</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rent and Payment Details -->
        <div class="form-section">
            <h3>Payment Details</h3>

            <div class="form-group">
                <label class="form-label required">Rent Payment Frequency</label>
                <select name="paymentFrequency" class="form-control select-field" required>
                    <option value="">Select payment frequency</option>
                    <option value="monthly">Monthly</option>
                    <option value="quarterly">Quarterly</option>
                    <option value="semi-annually">Semi-Annually</option>
                    <option value="annually">Annually</option>
                    <option value="other">Other</option>
                </select>
                <input type="text" name="otherPaymentFrequency" class="form-control" 
                       placeholder="Please specify if Other" style="display: none;">
            </div>

            <div class="form-group">
                <label class="form-label required">Rent Due Date</label>
                <select name="rentDueDate" class="form-control select-field" required>
                    <option value="">Select rent due date</option>
                    <option value="1st">1st of the month</option>
                    <option value="5th">5th of the month</option>
                    <option value="10th">10th of the month</option>
                    <option value="15th">15th of the month</option>
                    <option value="end-of-month">End of the month</option>
                    <option value="other">Other</option>
                </select>
                <input type="text" name="otherRentDueDate" class="form-control" 
                       placeholder="Please specify if Other" style="display: none;">
            </div>

            <div class="form-group">
                <label class="form-label">Late Payment Fees</label>
                <input type="number" name="lateFees" class="form-control currency-input" 
                       placeholder="Late payment fee amount" min="0">
            </div>
        </div>

        <!-- Parties Involved -->
        <div class="form-section">
            <h3>Parties Involved</h3>

            <div class="form-group">
                <label class="form-label required">Your Role</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="clientRole" value="landlord" required>
                        <label>Landlord</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="clientRole" value="tenant">
                        <label>Tenant</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="clientRole" value="property-manager">
                        <label>Property Manager</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="clientRole" value="other">
                        <label>Other</label>
                    </div>
                </div>
                <input type="text" name="otherClientRole" class="form-control" 
                       placeholder="Please specify if Other" style="display: none;">
            </div>

            <div class="form-group">
                <label class="form-label">Number of Tenants</label>
                <select name="numberOfTenants" class="form-control select-field">
                    <option value="">Select number of tenants</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5+">5 or more</option>
                </select>
            </div>
        </div>

        <!-- Lease Dispute or Concern -->
        <div class="form-section">
            <h3>Lease Concerns</h3>

            <div class="form-group">
                <label class="form-label">Primary Lease Concern</label>
                <select name="leaseConcern" class="form-control select-field">
                    <option value="">Select primary concern</option>
                    <option value="rent-dispute">Rent Dispute</option>
                    <option value="maintenance">Maintenance Issues</option>
                    <option value="lease-violation">Lease Violation</option>
                    <option value="security-deposit">Security Deposit Dispute</option>
                    <option value="termination">Lease Termination</option>
                    <option value="other">Other</option>
                </select>
                <input type="text" name="otherLeaseConcern" class="form-control" 
                       placeholder="Please specify if Other" style="display: none;">
            </div>

            <div class="form-group">
                <label class="form-label">Detailed Description of Concern</label>
                <textarea name="leaseDetails" class="form-control textarea-field" 
                          placeholder="Provide a detailed explanation of your lease-related issue"></textarea>
            </div>
        </div>

        <!-- Financial Information -->
        <div class="form-section">
            <h3>Financial Information</h3>

            <div class="form-group">
                <label class="form-label required">Gross Annual Income</label>
                <select name="income" class="form-control select-field" required>
                    <option value="">Select range</option>
                    <option value="0-25000">$25,000 or less</option>
                    <option value="25001-50000">$25,001–$50,000</option>
                    <option value="50001-75000">$50,001–$75,000</option>
                    <option value="75001-100000">$75,001–$100,000</option>
                    <option value="100001-125000">$100,001–$125,000</option>
                    <option value="125001+">$125,000+</option>
                </select>
            </div>
        </div>

        <!-- Legal Representation -->
        <div class="form-section">
            <h3>Legal Representation</h3>

            <div class="form-group">
                <label class="form-label required">When are you planning to hire an attorney?</label>
                <select name="hiringTimeline" class="form-control select-field" required>
                    <option value="">Select timeline</option>
                    <option value="immediately">Immediately</option>
                    <option value="this-week">This week</option>
                    <option value="this-month">This month</option>
                    <option value="this-year">This year</option>
                    <option value="exploring">Just exploring options</option>
                </select>
            </div>
        </div>

        <!-- Form Navigation -->
        <div class="form-navigation">
            <button type="button" class="nav-button back-button" onclick="showSummary()">Back to Summary</button>
            <button type="submit" class="nav-button submit-button">Submit Form</button>
        </div>
    </form>
</div>

<!-- Add form-specific script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Show/hide "Other" input fields for selects
    const selects = document.querySelectorAll('select');
    selects.forEach(select => {
        select.addEventListener('change', function() {
            const otherInput = this.nextElementSibling;
            if (otherInput && otherInput.tagName === 'INPUT') {
                otherInput.style.display = this.value === 'other' ? 'block' : 'none';
                otherInput.required = this.value === 'other';
            }
        });
    });

    // Handle client role details
    const clientRoleRadios = document.querySelectorAll('input[name="clientRole"]');
    const otherClientRoleInput = document.querySelector('input[name="otherClientRole"]');

    clientRoleRadios.forEach(radio => {
        radio.addEventListener('change', function() {
            otherClientRoleInput.style.display = this.value === 'other' ? 'block' : 'none';
            otherClientRoleInput.required = this.value === 'other';
        });
    });

    // Handle lease renewal options
    const noRenewalCheckbox = document.getElementById('noRenewal');
    const otherRenewalCheckboxes = document.querySelectorAll('input[name="renewalOptions"]:not(#noRenewal)');

    noRenewalCheckbox.addEventListener('change', function() {
        if (this.checked) {
            otherRenewalCheckboxes.forEach(cb => {
                cb.checked = false;
                cb.disabled = true;
            });
        } else {
            otherRenewalCheckboxes.forEach(cb => {
                cb.disabled = false;
            });
        }
    });

    otherRenewalCheckboxes.forEach(cb => {
        cb.addEventListener('change', function() {
            if (this.checked) {
                noRenewalCheckbox.checked = false;
                noRenewalCheckbox.disabled = true;
            } else {
                const anyChecked = Array.from(otherRenewalCheckboxes).some(checkbox => checkbox.checked);
                noRenewalCheckbox.disabled = anyChecked;
            }
        });
    });

    // Lease end date validation
    const leaseStartDate = document.querySelector('input[name="leaseStartDate"]');
    const leaseEndDate = document.querySelector('input[name="leaseEndDate"]');

    leaseEndDate.addEventListener('change', function() {
        if (leaseStartDate.value && this.value) {
            const start = new Date(leaseStartDate.value);
            const end = new Date(this.value);
            
            if (end <= start) {
                alert('Lease end date must be after the start date.');
                this.value = '';
            }
        }
    });

    // Currency input formatting
    const currencyInputs = document.querySelectorAll('.currency-input');
    currencyInputs.forEach(input => {
        input.addEventListener('blur', function() {
            if (this.value) {
                // Format as currency
                this.value = new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(this.value);
            }
        });
    });
});
</script>
{% endblock %}